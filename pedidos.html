<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel de Pedidos - Cozinha</title>
    <style>
        body { font-family: sans-serif; background: #0f172a; color: white; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .card { background: #1e293b; border-left: 10px solid #ef4444; padding: 15px; border-radius: 8px; position: relative; }
        .numero { font-size: 2.5rem; font-weight: 900; color: #ef4444; }
        .cliente { font-size: 1.2rem; margin-bottom: 10px; border-bottom: 1px solid #334155; }
        .item { margin: 5px 0; font-size: 1.1rem; }
        .obs { color: #94a3b8; font-size: 0.9rem; font-style: italic; }
        .btn-ok { background: #10b981; color: white; border: none; padding: 10px; width: 100%; border-radius: 5px; margin-top: 15px; cursor: pointer; font-weight: bold; }
        .vazio { text-align: center; font-size: 1.5rem; color: #475569; margin-top: 100px; }
    </style>
</head>
<body>
    <h1>PEDIDOS PENDENTES</h1>
    <div id="grid-pedidos" class="grid"></div>

    <script>
        function carregarPedidos() {
            const grid = document.getElementById('grid-pedidos');
            const fila = JSON.parse(localStorage.getItem("fila_pedidos") || "[]");

            if (fila.length === 0) {
                grid.innerHTML = '<div class="vazio">Nenhum pedido pendente...</div>';
                return;
            }

            grid.innerHTML = fila.map((p, index) => `
                <div class="card">
                    <div style="display:flex; justify-content:space-between; align-items:center">
                        <span class="numero">#${p.numero}</span>
                        <span>${p.hora}</span>
                    </div>
                    <div class="cliente">CLIENTE: ${p.cliente.toUpperCase()}</div>
                    <div>
                        ${p.itens.map(i => `
                            <div class="item">
                                • 1x ${i.nome} <br>
                                <span class="obs">${i.obs ? '└ ' + i.obs : ''}</span>
                            </div>
                        `).join('')}
                    </div>
                    <button class="btn-ok" onclick="concluirPedido(${index})">CONCLUÍDO / CHAMAR</button>
                </div>
            `).join('');
        }

        function concluirPedido(index) {
            let fila = JSON.parse(localStorage.getItem("fila_pedidos") || "[]");
            fila.splice(index, 1);
            localStorage.setItem("fila_pedidos", JSON.stringify(fila));
            carregarPedidos();
            // Som de alerta opcional
            new Audio('https://actions.google.com/sounds/v1/alarms/beep_short.ogg').play();
        }

        // Atualiza a cada 2 segundos ou quando houver mudança no storage
        setInterval(carregarPedidos, 2000);
        window.addEventListener('storage', carregarPedidos);
        carregarPedidos();
    </script>
</body>
</html>
